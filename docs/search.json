[
  {
    "objectID": "index.html#visão-geral",
    "href": "index.html#visão-geral",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "Visão Geral",
    "text": "Visão Geral\nEm muitas situações sabemos que as unidades experimentais não são homogêneas, e fazer o uso explícito da estrutura especial das unidades experimentais geralmente ajuda a reduzir o erro experimental (Meier (2022)).\nEm um curso de estatística básica, aprendemos como aplicar o teste \\(t\\) emparelhado. Esse teste é utilizado em situações em que dois tratamentos são aplicados no mesmo “objeto” ou “sujeito”. Pense, por exemplo, na aplicação de dois tratamentos, em paralelo, em seres humanos, como a aplicação de dois tipos de colírios diferentes, cada um aplicado em um dos dois olhos.\nSabemos que os indivíduos podem ser muito diferentes, mas devido ao fato de aplicarmos ambos os tratamentos no mesmo indivíduo, obtemos uma imagem clara do efeito do tratamento em cada indivíduo, tomando a diferença dos valores da variável resposta correspondentes aos dois tratamentos.\nIsso faz com que a variabilidade de sujeito para sujeito seja muito reduzida. Também dizemos que bloqueamos os sujeitos ou que um sujeito individual é um bloco.\nSob uma abordagem mais geral, conforme Montgomery (2001), podemos afirmar que em qualquer experimento, a variabilidade proveniente de um fator de perturbação pode afetar os resultados.\nEm geral, definimos um fator de perturbação como um fator do delineamento que, provavelmente tem um efeito sobre a variável resposta (\\(y\\)), mas em cujo efeito o experimentador não está interessado. Assim, a variabilidade que ele pode transmitir para a variável resposta deve ser minimizada.\nEm alguns experimentos, o fator de perturbação é desconhecido e incontrolável, isto é, não sabemos se o fator está afetando a variável resposta e se os seus níveis são os mesmos durante a realização do experimento. O princípio da experimentação que denominamos aleatorização é a técnica que permite ao experimentador proteger o experimento desse fator de perturbação à espreita.\nEm outros casos, o fator de perturbação é conhecido, mensurável, mas incontrolável. Se o experimentador conseguir pelo menos observar os valores desse fator em cada execução do experimento, ele pode ser incorporado na análise pela técnica denominada Análise de Covariância\nQuando o fator de perturbação da variabilidade é conhecido e controlável, o experimentador utiliza a técnica denominada blocagem para minimizar ou reduzir sistematicamente seu efeito sobre as comparações das médias dos tratamentos. A blocagem é uma técnica de experimentação extremamente importante e usada extensivamente.\nFatores de perturbação, conhecidos e controláveis, são chamados de blocos. O objetivo da blocagem é tornar um ambiente heterogêneo em subambientes homogêneos.\nFatores de perturbação (blocos) típicos incluem localização, o tempo, se um experimento é realizado em diferentes períodos de tempo (dia, semestre, ano etc.), pessoas, etc.\nEm inglês, um delineamento em blocos completamente aleatorizados (DBCA) pode ser traduzidp por Randomized Complete Block Design (RCBD). O que significa cada termo?\n\nRandomized: os tratamentos sáo atribuídos aleatoriamente dentro de cada bloco.\nComplete: Todos os tratamentos estão presentes em todos os bloco e cada tratamento é utilizado o mesmo número de vezes, geralmente uma vez, dentro de cada bloco.\nBlock: as unidades experimentais são agrupadas de forma a criar subgrupos homogênos.\nDesign: É o seu experimento.\n\n\n\n\n\n\n\nExemplo\n\n\n\nUm estudo no qual os participantes são, inicialmente, divididos em blocos (subconjuntos relativamente homogêneos) de acordo com alguma característica (por exemplo, idade) que não é um foco de interesse e são então atribuídos, aleatoriamente, aos diferentes tratamentos de tal forma que cada tratamento aparece uma vez em cada bloco.\nAssim, o número de participantes em cada bloco deve ser igual ao número de níveis do tratamento. Por exemplo, o seguinte arranjo de um tratamento com quatro níveis (A, B, C, D) e 16 indivíduos (de quatro grupos etários) é um delineamento em blocos completos:\n\n\n\n\nTratamentos\n\n\n\n\n\n\n\nBloco\n\n\n\n\n\n\ncriancas\nA\nB\nC\nD\n\n\nadolescentes\nB\nC\nD\nA\n\n\nadultos\nC\nD\nA\nB\n\n\nidosos\nD\nA\nB\nC\n\n\n\nAo garantir que o fator de perturbação (aqui, idade) seja igualmente representado em todos as condições experimentais, um DBC reduz ou elimina sua contribuição para o erro experimental."
  },
  {
    "objectID": "index.html#dbca-modelo-linear-normal---efeitos-fixos.",
    "href": "index.html#dbca-modelo-linear-normal---efeitos-fixos.",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "DBCA: Modelo Linear Normal - Efeitos Fixos.",
    "text": "DBCA: Modelo Linear Normal - Efeitos Fixos.\nO modelo estatístico linear associado a um DBCA pode ser representado por,\n\\[\ny_{ij} = \\mu + \\tau_i + \\beta_j + \\epsilon_{ij}, \\, \\text{sendo}\\, \\epsilon_{ij} \\sim i.i.d \\quad N(0,\\sigma^2)\n    \\begin{cases}\n    i = 1,\\ldots,a \\\\\n    j =  1,\\ldots,b\n    \\end{cases}\n\\] Sendo:\n\\(\\mu\\) = média global de \\(y\\).\n\\(\\tau_i\\) = efeito em \\(y_{i.}\\) devido ao tratamento \\(i\\). Ou seja, o efeito do tratamento \\(i\\). Sáo também denominados como efeitos principais.\n\\(\\beta_j\\) = efeito (sem interesse) do bloco \\(j\\).\n\\(y_{ij}\\) = resposta observada na unidade \\(j\\) devida ao tratamento \\(i\\).\n\\(\\epsilon_{ij}\\) = erro não observado (ou erro experimental).\nO DBCA é um modelo linear, portanto, assume que entre os blocos e os níveis dos fatores."
  },
  {
    "objectID": "index.html#dbca-tabela-da-análise-da-variância---efeitos-fixos",
    "href": "index.html#dbca-tabela-da-análise-da-variância---efeitos-fixos",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "DBCA: Tabela da Análise da Variância - Efeitos Fixos",
    "text": "DBCA: Tabela da Análise da Variância - Efeitos Fixos\n\\[\\begin{array}{l|l|l|l|l}\n        \\hline\n\\text{Fonte de Variação} & \\text{gl}  & \\text{SQ}        & \\text{QM}                       & F_{calculado} \\\\\n        \\hline\n        \\text{tratamentos}  & a-1        & SQ_{tratamentos}  & \\frac{SQ_{tratamentos}}{a-1}    & \\frac{QM_{tratamentos}}{QM_{resíduos}}    \\\\\n        \\text{blocos}       & b-1        & SQ_{blocos}       & \\frac{SQ_{blocos}}{b-1}         &                 \\\\\n        \\text{resíduo}      & (a-1)(b-1) & SQ_{resíduo}      & \\frac{SQ_{resíduo}}{(a-1)(b-1)} &                 \\\\\n        \\hline\n        \\text{total}        & ab - 1    & SQ_{total}         &                                 &                 \\\\\n        \\hline\n\\end{array}\\]\n\\(F_{tabelado}=F_{\\nu_1 = (a-1), \\nu_2 = (a-1)(b-1)}\\).\n\n\n\n\n\n\nEstimador do Erro Experimental\n\n\n\nO quadrado médio do resíduo:\n\\[\nQM_{resíduo} = \\frac{SQ_{resíduo}}{(a-1)(b-1)}\n\\] é o estimador do erro experimental no contexto deste modelo de um DBCA.\n\n\nConsiderando que são \\(a\\) níveis do fator de interesse e \\(b\\) blocos. A hipótese de interesse é:\n\\[\n\\begin{cases}\nH_o:  & \\mu_1 = \\mu_2 = \\ldots = \\mu_a \\,\\, \\text{(as médias dos tratamentos são iguais)}  \\\\\nH_a:  & \\text{Pelo menos duas médias são diferentes}\n\\end{cases}\n\\]\nRegras de Decisão do teste F:\nSe \\(F_{calculado} > F_{tabelado}\\), rejeitamos a hipótese nula de que as médias dos tratamentos são iguais, caso contrátio, náo rejeitamos a hipótese nula, dado o nível de significância \\(\\alpha\\) escolhido.\nEntretanto, a alternativa mais comum para interpretar o resultado do teste F é utilizar o valor-p do teste. Por exemplo, caso adote-se \\(\\alpha = 0.05\\) = 5%, a regra de decisão é:\n\nSe valor-p \\(<\\) 0.05, o teste fornece evidência para rejeitar a hipótese nula de que as médias dos tratamentos são iguais.\nSe valor-p \\(>\\) 0.05, o teste fornece evidência para rejeitar a hipótese nula de que as médias dos tratamentos são iguais."
  },
  {
    "objectID": "index.html#sumário-das-principais-características-de-um-dbc",
    "href": "index.html#sumário-das-principais-características-de-um-dbc",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "Sumário das Principais Características de um DBC",
    "text": "Sumário das Principais Características de um DBC\nUso:\n\nApropriado quando se tem um fator de perturbação atuando sobre a variável resposta.\nO ideal é que cada tratamento ocorra em cada bloco o mesmo número de vezes, usualmente uma vez.\nDeve-se minimizar a variação dentro de cada bloco e maximizar a variação entre os blocos.\n\nVantagens:\n\nControla um fator de perturbação (conhecido e controlável) que pode atuar sobre a variável resposta (tempo, temperatura etc.), aumentando a precisão do experimento, ou seja, reduzindo o erro experimental.\nUm DBCA pode acomodar qualquer número de tratamentos e qualquer número de blocos. Entretanto, o ideal é que cada tratamento seja replicado o mesmo número de vezes em cada bloco.\nUtilizando blocos com diferentes condições, os resultados do experimento podem ter uma amplitude maior.\nA análise estatística é simples.\n\nDesvantagens:\n\nDados faltantes reduzem o poder dos testes e a cobertura dos intervalos de confiança.\nSe existir mais de uma fator de perturbação, conhecido e controlável, a utilização do DBCA é ineficiente.\nSe as condições experimentais forem de fato homogêneas, um delineamento inteiramente aleatorizado é mais eficiente que o DBCA.\nNa medida em que aumenta-se o número de tratamentos, mais itens heterogêneos podem ser utilizados e a blocagem correta torna-se cada vez mais complexa, neste caso outros delineamentos podem ser mais eficientes."
  },
  {
    "objectID": "index.html#etapas-da-análise-de-um-dbca",
    "href": "index.html#etapas-da-análise-de-um-dbca",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "Etapas da Análise de um DBCA",
    "text": "Etapas da Análise de um DBCA\n\nEstruturação e Importação do Arquivo de Dados.\nAnálise Exploratória dos Dados\nEstimação do Modelo Linear Normal da ANOVA.\nDiagnóstico do Modelo (verificar as hipóteses do modelo linear normal).\nComparações Múltiplas.\n\nAs etapas típicas da análise dos dados produzidos por um DBCA serão ilustradas pela resolução das questões (1 a 9) associadas ao seguinte experimento:"
  },
  {
    "objectID": "index.html#análise",
    "href": "index.html#análise",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "Análise",
    "text": "Análise\nVamos ilustrar a análise de dados de um experimento que utilizou um DBCA utilizando o seguinte experimento:\n\n\n\n\n\n\nExperimento\n\n\n\nTrês soluções de lavagem estão sendo comparadas para avaliar a sua eficiência em retardar o crescimento de bactérias em containers de leite. A Análise é feita em um laboratório, e apenas três ensaios podem ser executados em qualquer dia. O experimentador decide usar um delineamento em blocos completos aleatorizados (DBCA). As observações são tomadas durante quatro dias, e os dados são apresentados na tabela abaixo.\n\n\n\n1. Identifique o bloco (fator de perturbação), o fator de interesse (tratamento) e seus níveis e a variável resposta deste experimento. Além disso, descreva o modelo linear do experimento.\n\nFator de Perturbação/Blocos: dias.\nFator de Interesse/Tratamento: soluções para lavagem de containers de leite.\nNíveis do Fator de Interesse/Tratamento: As três soluções de lavagem distintas\nvariável Resposta (\\(y\\))]: O crescimento, medido pela contagem, de bactérias\n\nSendo o crescimento (contagem) de bactérias a variável resposta e representada por \\(y_{ij}\\), as solucões testadas os tratamentos e representados por sol, os quatro dias os blocos e representados por dia, podemos representar o modelo linear do experimento como:\n\\[\ny_{ij} = \\mu +\n                      \\tau_1 sol_{1} +\n                      \\tau_2 sol_{2} +\n                      \\tau_3 sol_{3} +\n                      \\beta_{1}dia_{1} +\n                      \\beta_{2}dia_{2} +\n                      \\beta_{3}dia_{3} +\n                      \\beta_{4}dia_{4} +\n                      \\epsilon_{ij}\n\\]\n\n\n2. Estruturação e Importação do Arquivo de Dados\nA estrutura correta de um arquivo de dados para o caso de um experimento que utilizou um DBCA é ilustrada a seguir:\n\n\n\n\n \n  \n    solucao \n    dia \n    y \n  \n \n\n  \n    S1 \n    D1 \n    13 \n  \n  \n    S1 \n    D2 \n    22 \n  \n  \n    S1 \n    D3 \n    18 \n  \n  \n    S1 \n    D4 \n    39 \n  \n  \n    S2 \n    D1 \n    16 \n  \n  \n    S2 \n    D2 \n    24 \n  \n  \n    S2 \n    D3 \n    17 \n  \n  \n    S2 \n    D4 \n    44 \n  \n  \n    S3 \n    D1 \n    5 \n  \n  \n    S3 \n    D2 \n    4 \n  \n  \n    S3 \n    D3 \n    1 \n  \n  \n    S3 \n    D4 \n    22 \n  \n\n\n\n\n\nConsiderando que o script R que contém seus código para analisa os dados\nestão em uma pasta qualquer contendo uma subpasta denominada dado que contem seu arquivo de dados, para importar, por exemplo, um arquivo texto separado por tabulações denominado solucao.txt, pode-se utilizar o seguinte código\n\n# Pacotes utilizados\nlibrary(readr)\nlibrary(dplyr)\n\n# Importando os dados\ndados <- read_tsv(\"dados/solucao.txt\", col_names = TRUE)\n\n# Verificando os dados\nglimpse(dados)\n\nRows: 12\nColumns: 3\n$ solucao <chr> \"S1\", \"S1\", \"S1\", \"S1\", \"S2\", \"S2\", \"S2\", \"S2\", \"S3\", \"S3\", \"S…\n$ dia     <chr> \"D1\", \"D2\", \"D3\", \"D4\", \"D1\", \"D2\", \"D3\", \"D4\", \"D1\", \"D2\", \"D…\n$ y       <dbl> 13, 22, 18, 39, 16, 24, 17, 44, 5, 4, 1, 22\n\n\nEm experimentos, em geral, fatores (ou tratamentos) são variáveis categóricas, como usamos a linguagem R, é melhor converter o tratamento (solucao) e os blocos (dia) para a classe factor para efetuar a análise dos dados. Essa conversão pode ser obtida usando a função transmute do pacote dplyr:\n\n# pacote utlizado\nlibrary(ggplot2)\n\ndados <- dados %>% transmute(solucao = as.factor(solucao),\n                             dia = as.factor(dia),\n                             y = as.numeric(y))\n\nglimpse(dados)\n\nRows: 12\nColumns: 3\n$ solucao <fct> S1, S1, S1, S1, S2, S2, S2, S2, S3, S3, S3, S3\n$ dia     <fct> D1, D2, D3, D4, D1, D2, D3, D4, D1, D2, D3, D4\n$ y       <dbl> 13, 22, 18, 39, 16, 24, 17, 44, 5, 4, 1, 22\n\n\nCom esses passsos, os dados foram importados e estruturados em um formato adequado para a análise.\n\n\n3. Faça uma Análise Exploratória dos Dados\n\n\n\n\n\n\nDica: Análise Exploratória dos Dados\n\n\n\nUma Análise Exploratória dos Dados com gráficos e estatísticas, é uma parte importante de qualquer análise para:\n\nentender as propriedades dos dados.\nestruturar os dados no formato adequado para análise.\nencontrar padrões nos dados.\ndescrever os dados/fenômeno.\nidentificar erros nos dados.\nsugerir estratégias de modelagem.\ndepurar análises.\ncomunicar resultados.\n\n\n\nUm boxplot comparativo das distribuições é o gráfico exploratório usual para explorar dados envolvendo uma variável numérica e uma ou mais variáveis categóricas.\nEntretanto, um boxplot requer uma amostra considerável (50 observações por grupo pelo menos), e caso seja utilizado em amostras pequenas, tende distorcer ou ocultar as propriedades da distribuição.\nPara amostras menores, como a do experimento em questão um gráfico de violino (violin plot) é mais adequado e tende a retratar melhor as propriedades das distribuições por grupo (no caso, por tratamento).\nPara produzir um gráfico de violino usando o pacote ggplot2, podemos utilizar a função geom_violin() e o seguinte código:\n\n# Violin plot entre y e solucao\n\nggplot(dados, aes(x = solucao, y = y)) + \n   geom_violin() +  \n   stat_summary(fun.y = \"median\", geom = \"point\", size = 2, color = \"red\") + \n   xlab(\"\") + \n   ylab(\"crescimento (quantidade) de bactérias\") + \n   geom_jitter(shape  = 16, position = position_jitter(0.2)) + \n   scale_x_discrete(labels = c(\"S1\" = \"Solução 1\", \n                               \"S2\" = \"Solução 2\",\n                               \"S3\" = \"Solução 3\")) +\n   theme_minimal()\n\n\n\n\nFig. 1. Gráfico de violino comparativo entre a medida de crescimento de bactérias e as soluções testadas. O ponto vermelho representa a mediana dos dados e os pontos pretos os dados.\n\n\n\n\nObservando a Figura 1, pode-se verificar que a solução 3, aparentemente, foi a que apresentou a maior redução no crescimento de bactérias nos containers de leite. Além disso, parece não haver diferença entre os resultados produzidos pelas soluções 1 e 2. Por fim, a Figura 1 mostra que as distribuições dos dados três soluções apresentam assimetria positiva devido a possíveis outliers nas distribuições dos resultados das três soluções.\n\n4. Estimação do Modelo Linear Normal.\nA estimação do modelo linear normal associado a um DBCA consiste, basicamente, na obtenção da tabela da Análise da Variância apropriada. No caso do DBCA d experimento que estamos analisando, podemos obtê-la com o seguinte código:\n\n# Estimação do Modelo com blocagem dos dias\nmod_dbca <- aov(y ~ solucao + dia, data = dados)\nsummary(mod_dbca)\n\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nsolucao      2  703.5   351.8   40.72 0.000323 ***\ndia          3 1106.9   369.0   42.71 0.000192 ***\nResiduals    6   51.8     8.6                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nA tabela da ANOVA resultante lista inicialmente os fatores analisados que estão sendo testadas no modelo, neste caso, temos solucao (tratamento ou fator de interesse) e dia (bloco ou fator de perturbação) e os resíduos do modelo (Residuals). Toda a variação que não é explicada pelos tratamentos e pelos blocos está incorporada na variância residual.\nA seguir descrevemos as colunas da tabela da ANOVA obtida:\n\nDf: A coluna Df exibe os graus de liberdade para a variável independente (o número de níveis na variável menos 1) e os graus de liberdade para os resíduos (o número total de observações menos um e menos o número de níveis nas variáveis independentes).\nSum Sq: A coluna Sum Sq exibe a partição da soma de quadrados total dos dados efetuada pela ANOVA.\nMean Sq: A coluna Mean Sq são os quadrados médios associados aos fatores em análise e aos resíduos, calculados dividindo-se a soma dos quadrados pelos respectivos graus de liberdade associados a cada fator e aos resíduos do modelo.\nF value: A coluna F value é a estatística de teste do teste F, obtida pela divisão do quadrado médio de cada fator pelo quadrado médio dos resíduos. Quanto maior o valor F, maior a probabilidade de que a variação causada pelos tratamentos seja real e não devida ao acaso, ou à variabilidade natural do fenômeno.\nPr(>F): A coluna Pr(>F) é o valor-p do teste F, que estima a probabilidade de obtermos a estatística do teste F calculada a partir dos dados ter ocorrido, se a hipótese nula de nenhuma diferença entre os médias dos tratamentos fosse verdadeira. Portanto, quanto menor o valor-p, em relação ao nível de significância adotado (em geral, \\(\\alpha = 0.05\\)), maior a chance de rejeitarmos a hipótese nula de que não há diferença entre as médias dos tratamentos, e vice-versa.\n\nComo o valor-p associado ao teste F entre as médias de contatem de bactérias das soluções testadas foi 0,0003, os dados fornecem forte evidência para rejeitarmos a hipótese nula de que as médias dos tratamentos são iguais.\nTamanho do Efeito\nNo contexto de testes semelhantes a ANOVA, é comum relatar tamanhos de efeitos. Esses tamanhos de efeito representam a quantidade da variabilidade explicada por cada um dos fatores incluídos no modelo.\nPor exemplo, podemos perguntar qual é a porcentagem da variação total no crescimento de bactérias associada aos tratamentos (soluções de lavagem). Esta medida é chamada de Eta-quadrático (\\(\\eta^{2}\\)):\n\\[\n\\eta^2 = \\frac{SQ_{tratamento}}{SQ_{total}} = \\frac{703.5}{703.5 + 1106.9 + 51.8} =\n0.38 = 38\\%\n\\] Quando adicionamos mais termos ao nosso modelo, como é o caso do experimento que estamos analisando, podemos fazer duas perguntas diferentes sobre a porcentagem de variância explicada por um preditor - quanta variância é explicada pelo fator no total e quanto da variação é explicada ao controlar quaisquer outros preditores.\nA última pergunta é respondida pelo Eta-parcial quadrático \\(\\eta^{2}_{p}\\), que é a porcentagem da variância parcial (após controlar outros fatores no modelo) associada a um fator:\n\n# Estimação dos tamanhos de efeitos\neffectsize::eta_squared(mod_dbca, partial = TRUE)\n\n# Effect Size for ANOVA (Type I)\n\nParameter | Eta2 (partial) |       95% CI\n-----------------------------------------\nsolucao   |           0.93 | [0.75, 1.00]\ndia       |           0.96 | [0.83, 1.00]\n\n- One-sided CIs: upper bound fixed at [1.00].\n\n\n\n\n\n5. Diagnóstico do modelo.\nUma das partes mais importantes da análise dos dados de um DBCA (e dos demais delineamentos), consiste em verificar se o modelo linear normal utilizado é adequado.\nEm geral, no caso de um DBCA, precisamos verificar:\n\nA validade da hipótese da normalidade aproximada dos resíduos do modelo,\nA validade da hipótese da variância dos resíduos ser aproximadamente constante (ou homogênea) em relação aos tratamentos.\nA validade da hipótese de aditividade do modelo linear normal, isto é, de que não há interação entre blocos e tratamentos.\n\n\n5.1 Verificação da normalidade dos resíduos\nÉ sempre importante analisar gráficos dos resíduos de modelos estatísticos, entretanto, infelizmente, não é usual reportar esses gráficos nos artigos científicos, prática que depoe contra o artigo e as práticas da revista.\nAlém da relevância, em si, de se analisar gráficos dos resíduos, sua importância deve-se também às conhecidas limitações dos testes de hipóteses formais comumente utilizados e reportados nas revistas.\nGrágico Quantil-Quantil dos Resíduos\nPodemos utilizar a função ggqqplot() do pacote ggpubr para produzirmos um gráfico quantil-quantil dos resíduos. Além dos resíduos, a função produz intervalos de confiança, caso os resíduos estejam dentro da região cinza, que representa os intervalos de confiança, temos evidência de que os resíduos seguem uma distribuição aproximadamente normal.\nPara o experimento em questão tempos:\n\n# pacote utilizado\nlibrary(ggpubr)\n\n# Gráfico quantil-quantil dos resíduos\nggqqplot(residuals(mod_dbca)) + \n  xlab(\"quantis teóricos de uma distribuição normal padrão\") + \n  ylab(\"resíduos\")\n\n\n\n\nFig. 2. Gráfico quantil-quantil para analisar a normalidade dos resíduos.\n\n\n\n\nAnalisando a Figura 2, é fácil verificar que os resíduos estão situados dentro da região de confiança (95%), portanto podemos considerar a distribuição dos resíduos compatível com uma distribuição normal padrão aproximada.\nTeste de Shapiro-Wilk de normalidade dos resíduos\nUm dos testes mais comumente utlizados para testar formalmente se os resíduos de um modelo linear experimental são aproximadamente normais é o teste de Shapiro-Wilk.\nDe forma simplificada, podemos dizer que a hipótese nula do teste é que os resíduos são, aproximadamente, normalmente distribuídos. Assim, se o valor-p do teste for menor que o nível de significância escolhido (\\(\\alpha\\)), então a hipótese nula é rejeitada e há evidências de que os resíduos testados não são normalmente distribuídos.\nPor outro lado, se o valor-p for maior que o nível de significância escolhido, a hipótese nula (de que os dados vieram de uma população normalmente distribuída) não pode ser rejeitada. Por exemplo, para um nível \\(\\alpha\\) de \\0,05, um valor p inferior a 0,05 implica na rejeição da hipótese nula de que os dados são de uma população com distribuição (aproximadamente) normalmente distribuída.\nPara o experimento que estamos analisando, podemos executar o teste de Shapiro-Wilk utilizando a função interna shapiro.test():\n\n#### Teste de Shapiro-Wilks\nshapiro.test(mod_dbca$residuals)\n\n\n    Shapiro-Wilk normality test\n\ndata:  mod_dbca$residuals\nW = 0.93208, p-value = 0.4027\n\n\nConsiderando \\(\\alpha = 0.05\\), como o valor-p do teste é muito superior ao nível de significância escolhido, os dados fornecem forte evidência para não rejeitarmos a hipótese nula de que os resíduos seguem uma distribuição aproximadamente normal.\n\n\n5.2 Verificação da constância aproximada da variância dos resíduos\nPara testar a hipóteses de constância da variância dos resíduos entre os níveis dos tratamentos, as três soluções no caso, recomendo utilizar a função interna fligner.test() que implementa o teste de constância da variância de Fligner-Killeen.\nA recomendação deve-se ao fato de que o teste Fligner-Killeen foi considerado, em um estudo de simulação, como um dos testes de homogeneidade de variâncias mais robustos contra desvios da normalidade, ver Conover, Johnson & Johnson (1981).\n\n#### Teste de Bartlett: variancia homogenea pelo tratamento\nfligner.test(y ~ solucao, data = dados)\n\n\n    Fligner-Killeen test of homogeneity of variances\n\ndata:  y by solucao\nFligner-Killeen:med chi-squared = 1.4915, df = 2, p-value = 0.4744\n\n\nConsiderando \\(\\alpha = 0.05\\), como o valor-p do teste é muito superior ao nível de significância escolhido, os dados fornecem forte evidência para não rejeitarmos a hipótese nula de que os resíduos possuem variância constante (ou homogênea) entre as diferentes soluções (tratamentos) testadas.\n\n\n5.3 Verificando se há interação entre bloco e tratamento\nO modelo estatístico linear normal utilizado para um DBCA:\n\\[\ny_{ij} = \\mu + \\tau_i + \\beta_j + \\epsilon_{ij},\n\\]\né completamente aditivo, isto é, os efeitos devidos aos tratamentos e aos blocos são adicionados, e não multiplicados, por exemplo. Apesar deste modelo aditivo simples ser frequentemente útil, há situações nas quais ele é inadequado.\nEspecificamente, o modelo aditivo é inadequado em situações nas quais há interação entre tratamentos e blocos. Interações podem ocorrer, por exemplo, quando a variável resposta (\\(y_{ij}\\)) é medida na escala errada. Assim, se uma relação que é multiplicativa na escala original, digamos:\n\\[\nE(y_{ij}) = \\mu \\tau_i \\beta_j\n\\]\nela pode ser tornada aditiva (ou linear) utilizando uma escala logarítimica:\n\\[\n\\ln(E(y_{ij})) = \\ln(\\mu) + \\ln(\\tau_i) + \\ln(\\beta_j)\n\\]\nEste tipo de interação pode ser eliminada pela transformação logaritmica, entretanto, nem todas as interações pode ser tratadas tão facilmente.\nSe interações estão presentes, elas podem afetar seriamente e até invalidar a Análise da Variância de um experimento. Em geral, a presença de interações, infla o quadrado médio do resíduo e podem afetar adversamente a comparação entre as médias dos tratamentos.\nQuando ambos os fatores sào de interesse (o que não é o caso em um DBCA), pode-se utilizar delineamentos fatoriais para incorporar o efeito de interações.\nHá métodos gráficos e o teste de hipóteses formal de aditividade de Tukey para verificar a presença de interação.\nMétodo Gráfico\nUm gráfico de interação exibe a média (ou outra estatística) da variável resposta contra combinações dos fatores (blocos e tratamentos), ilustrando assim possíveis interações. A função interna interaction.plot() da linguagem R pode ser utilizad para produzir este gráfico, a sintáxe da função para o exeperimento que estamos analisando é:\n\n# Verificando Interação entre Blocos e níveis do Fator (solucao)\ninteraction.plot(dados$dia, dados$solucao, dados$y, fixed = TRUE)   \n\n\n\n\nFig. 3. Gráfico de interação entre a média da variável resposta e combinaçòes das soluções (tratamento) e dias (blocos).\n\n\n\n\nIdealmente, as linhas de um gráfico de interação devem ser paralelas, ou seja, não devem se cruzar. Apesar da Figura 3 exibir um cruzamento, não parece haver uma interação relevante entre as solucões (tratamentos) e os dias (blocos). Uma limitaçào desse gráfico é que ele reflete possíveis imprecisões (alta variabilidade) nas estimativas das médias, o que parece ser o caso nesse experimento devido ao pequeno tamanho da amostra e à possível presença de outliers.\nTeste de Aditividade de Tukey\nO teste de aditividade de Tukey testa as seguintes hipóteses:\n\\[\n\\begin{cases}\nH_o:  & \\text{efeitos principais e blocos são aditivos,}  \\\\\nH_a:  & \\text{efeitos principais e blocos são não-aditivos}\n\\end{cases}\n\\] Podemos utilizar a função tukey.add.test(variável resposta, tratamentos, blocos) do pacote asbio para executar esse teste. No caso do experimento em análise temos:\n\n# Testa H0: Não há efeito de interação\nasbio::tukey.add.test(dados$y, dados$solucao, dados$dia)\n\n\nTukey's one df test for additivity \nF = 2.7732343   Denom df = 5    p-value = 0.1567331\n\n\nComo o valor-p do teste (0.16) é maior que \\(\\alpha = 0.05\\), não rejeitamos a hipótese nula de que os efeitos principais (\\(\\tau_i\\)) e os blocos (\\(\\beta_j\\)) são aditivos, isto é, o resultado do teste fornece evidência de que não há interação entre blocos e tratamento.\n\n\n\n6. Os resultados indicaram diferenças entre os crescimentos médios de bactérias produzidos pelas três soluções?\nUma Análise da Variância dos resultados do delineamento em blocos completos executado foi conduzida para comparar o efeito de três diferentes soluções de lavagem sobre o crescimento de bactérias em containers de leite. A ANOVA indicou que houve uma diferença entre pelo menos duas soluções [ F(2, 6) = 40.72, p < .001, \\(\\eta^2_p\\) = .93]. A análise dos resíduos indicou a adequação do modelo utilizado.\n\n\n7. Qual solução deveria ser recomendada? Utilize os testes de Fisher e Tukey.**\nComo a ANOVA indicou diferenças entre o crescimento (quantidade) média de bactérias entre as soluções testadas, dos laboratórios, surgem outras perguntas:\n\nQuais soluçóes apresentaram médias estatisticamente iguais e quais apresentaram médias estatisticamente iguais?\nQual solução apresentou o melhor resultado? Ou seja, apresentou a maior redução no crescimento de bactérias nos containers de leite?\nNecessitamos de procedimentos de comparações múltiplas de médias para responder estas questões.\n\nEntre os dois mais utilizados, temos os testes de Fisher e de Tukey.\nTeste de Fisher\nDuas médias de tratamentos são estatisticamente diferentes segundo o teste da diferença mínima significativa (dms) de Fisher se:\n\\[\n|\\bar{y}_i - \\bar{y}_j| \\geq dms = t_{(\\alpha, gl_{resíduos})} \\sqrt{\\frac{2QM_{resíduos}}{J}}\n\\]\nsendo \\(gl_{resíduos}\\) o grau de liberdade do resíduo:\n\nO teste de Fisher requer que o teste F da ANAVA tenha rejeitado a hipótese nula de igualdade entre as médias de tratamentos de forma a controlar o erro tipo I\nEste teste é liberal, no sentido de que possui grande poder e erro tipo I maior que um teste mais conservador.\n\n\n### Teste de Fisher\nagricolae::LSD.test(mod_dbca, \n                    \"solucao\", \n                    alpha = 0.05, \n                    p.adj = \"fdr\", \n                    console = TRUE)\n\n\nStudy: mod_dbca ~ \"solucao\"\n\nLSD t Test for y \nP value adjustment method: fdr \n\nMean Square Error:  8.638889 \n\nsolucao,  means and individual ( 95 %) CI\n\n       y       std r      LCL      UCL Min Max\nS1 23.00 11.284207 4 19.40402 26.59598  13  39\nS2 25.25 12.996794 4 21.65402 28.84598  16  44\nS3  8.00  9.486833 4  4.40402 11.59598   1  22\n\nAlpha: 0.05 ; DF Error: 6\nCritical Value of t: 2.446912 \n\nMinimum Significant Difference: 5.085484 \n\nTreatments with the same letter are not significantly different.\n\n       y groups\nS2 25.25      a\nS1 23.00      a\nS3  8.00      b\n\n\nTeste de Tukey\nDuas médias de tratamentos são estatisticamente diferentes segundo o teste de Tukey se:\n\\[\n|\\bar{y}_i - \\bar{y}_j| \\geq dhs = q_{(\\alpha, I, gl_{resíduos})} \\sqrt{\\frac{QM_{resíduos}}{J}}\n\\]\nEste teste é muito conservador, ou seja tem o menor poder em relação a testes liberais e o menor erro tipo I.\n\n### Teste de Tukey\nTukeyHSD(mod_dbca, \n         \"solucao\", \n         conf.level = 0.95)\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = y ~ solucao + dia, data = dados)\n\n$solucao\n        diff        lwr        upr     p adj\nS2-S1   2.25  -4.126879   8.626879 0.5577862\nS3-S1 -15.00 -21.376879  -8.623121 0.0008758\nS3-S2 -17.25 -23.626879 -10.873121 0.0004067\n\n\nNo caso do experimento analisado, os dois testes produziram os mesmos resultados:\n\no crescimento médio de bactérias devido às soluções 1 e 2 são estatisticamente iguais. Médias identificadas com a mesma letra representam esse fato, apresentam a letra a no caso.\no crescimento médio de bactérias produzido pela solução 3 é estatisticamente diferente das médias produzidas pelas soluções 1 e 2, repare que apenas a média produzida pela solução 3 contém a letra b.\n\nPortanto, a solução recomendada, com fundamento nos resultados do experimento, seria a solução 3.\n\n\n8. Comunicando os resultados finais da análise.\nUma Análise da Variância dos resultados do delineamento em blocos completos executado foi conduzida para comparar o efeito de três diferentes soluções de lavagem sobre o crescimento de bactérias em containers de leite. A ANOVA indicou que houve uma diferença entre pelo menos duas soluções [ F(2, 6) = 40.72, p < .001, \\(\\eta^2_p\\) = .93]. A análise dos resíduos indicou a adequação do modelo utilizado.\nComparações post hoc usando o teste de Tukey indicaram que o crescimento médio de bactérias após a aplicação da solução 3 foi significativamente diferente dos resultados obtidos com a solução 1 [p < 0.001, IC 95%. = [-21,38, -8,62] e com a solução 2 [p < 0.001, IC 95%. = [-23,63, -10,87].\nNão houve diferença estatisticamente significativa entre o crescimento médio de bactérias produzidos pelas soluções 1 e 2 [p < 0,5578, IC 95%. = [-4,13, -8,63].\n\n\n9. Utilize um Método Não-Paramétrico"
  },
  {
    "objectID": "index.html#referências",
    "href": "index.html#referências",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "Referências",
    "text": "Referências\n\n\nCasella, George. 2008. Statistical Design. Springer Texts em Statistics. Springer.\n\n\nMeier, Lukas. 2022. ANOVA and Mixed Models: A Short Introduction Using R. CRC Press.\n\n\nMontgomery, Douglas C. 2001. Design and Analysis of Experiments. 5.ª ed. John Wiley & sons."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Washington Santos da Silva",
    "section": "",
    "text": "Professor Titular do IFMG - Campus Formiga. Professor e Pesquisador do quadro permanente do Mestrado Profissional em Administração."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Delineamento em Blocos Completos Aleatorizados (DBCA)",
    "section": "",
    "text": "Os conceitos a seguir foram baseados em Casella (2008).\n\n\n\n\n\n\nUnidade Experimental\n\n\n\nA unidade experimental é a unidade (sujeito, planta, vaso, animal…) que é atribuído aleatoriamente a um tratamento.\n\n\nA unidade experimental, como o nome indica, é a unidade básica do experimento, e define a unidade a ser replicada para aumentar os graus de liberdade. Na definição de unidade experimental, a frase “atribuída aleatoriamente” é de importância crucial.\n\n\n\n\n\n\nUnidade de Amostragem\n\n\n\nUma unidade de amostragem é o objeto que é medido em um experimento. Pode ser diferente da unidade experimental.\n\n\n\n\n\n\n\n\nRepetição\n\n\n\nO princípio da repetição consiste em aplicarm o mesmo tratamento a várias unidades experimentais em um mesmo experimento.\n\n\nO princípo da repetição permite obter a variação entre unidades experimentais, ou seja, permite obter uma estimativa do erro experimental.\n\n\n\n\n\n\nAleatorização\n\n\n\nTalvez o princípio mais fundamental da experimentação seja a aleatorização, ou seja, obter as observações (ou, mais precisamente, as unidades experimentais) em um forma aleatória que é tão livre de viés quanto possível.\n\n\nA ideia básica da aleatorização é que, dado um delineamento, a atribuição das unidades experimentais aos tratamentos deve ser escolhida aleatoriamente, com igual probabilidade, entre todas as atribuições possíveis. Essa estratégia resulta em uma amostra aleatória simples.\nA atribuição aleatória de unidades experimentais a tratamentos deve resultar nos seguintes resultados desejáveis:\nEliminação de viés sistemático. O viés vem em muitas formas, e algumas delas são desconhecidas. Alguns exemplos são gradientes de luz ou temperatura, tendência de entrevistador em pesquisas e outras ocorrências. A aleatorização é uma maneira de quebrar um efeito sistemático.\nObtenção de uma amostra representativa. O objetivo final em qualquer experimento é fazer uma inferência válida para uma população, portanto, os dados devem ser representativos dessa população. A aleatorização é necessária para se obter uma amostra representativa.\nControla variáveis ou fatores de confundimento\nFatores de confundimento existem em todas os experimentos. Por exemplo, considere um experimento com seres humanosp para testar o efeito de dietas na pressão arterial, medida em 12 indivíduos. Embora possamos recrutar sujeitos com um estado geral de saúde semelhante, fatores de confundimento como estilo de vida, raça, disposição genética ou muitos outros fatores podem influenciar os resultados.\nApesar de ser possível controlar alguns fatores de confundmento, tal como raça, outros fatores são incontroláveis, e até mesmo desconhecidos, como a disposição genética. A aleatorização ajudará a distribuir essa variação desconhecida ao longo do experimento, quebrando a influência do fator de confundimento."
  },
  {
    "objectID": "about.html#educação",
    "href": "about.html#educação",
    "title": "Washington Santos da Silva",
    "section": "Educação",
    "text": "Educação\nUniversidade Federal de Lavras | Lavras, MG.\nDSc. e MSc. em Estatística e Experimentação Agropecuária.\nUniversidade Federal de Minas Gerais | Belo Horizonte, MG.\nB.A em Economia."
  }
]